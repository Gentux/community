guacamole-client:
 extends:
  file: ./docker-compose.yml
  service: guacamole-client
 build: ./canva/guacamole-client
 dockerfile: Dockerfile-dev
 ports:
  - 8000:8000
 volumes:
  - ./canva/guacamole-client/:/opt
  - ./canva/guacamole-client/noauth-logged/target/guacamole-auth-noauthlogged-0.9.8.jar:/etc/guacamole/extensions/guacamole-auth-noauthlogged-0.9.8.jar

guacamole-server:
 extends:
  file: ./docker-compose.yml
  service: guacamole-server

nanocloud-backend:
 extends:
  file: ./docker-compose.yml
  service: nanocloud-backend
 build: ../nanocloud
 dockerfile: Dockerfile-dev
 volumes_from:
  - nanocloud-frontend
  - nanocloud-canva
 volumes:
  - ../nanocloud:/go/src/github.com/Nanocloud/community/nanocloud/

nanocloud-frontend:
 extends:
  file: ./docker-compose.yml
  service: nanocloud-frontend
 volumes:
  - /opt/front
 build: ../webapp
 dockerfile: Dockerfile-dev
 volumes:
  - ../webapp/:/opt/front
 restart: always
 container_name: "nanocloud-frontend"

nanocloud-canva:
 extends:
  file: ./docker-compose.yml
  service: nanocloud-canva
 volumes:
  - /opt/canva
  - ./canva/frontend/:/opt/canva
  - ./nginx/conf/certificates:/opt/ssl/:ro
 build: ./canva/frontend
 dockerfile: Dockerfile-dev
 ports:
  - 49152:49152
  - 4200:4200
 restart: always
 container_name: "nanocloud-canva"

proxy:
 extends:
  file: ./docker-compose.yml
  service: proxy

postgres:
 extends:
  file: ./docker-compose.yml
  service: postgres

iaas-module:
 extends:
  file: ./docker-compose.yml
  service: iaas-module
 build: ./iaas
 dockerfile: Dockerfile-dev
 volumes:
  - ./iaas/:/go/src/github.com/Nanocloud/community/modules/iaas/
